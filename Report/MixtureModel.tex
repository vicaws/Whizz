\section{Modelling Customer Behaviors}
\label{sec:model}

Markov State and Mixture Model

The goal is to assess the likelihood of customers canceling by examining their behaviors.

We model the behaviors of customers as the emission of Markov states, either hidden or observable. With this modelling assumption, we can also do temporal transitional analysis to gain insights of customers' dynamic behavioral change.

We can define states by some features.

We can also infer states from data through clustering task. To undertake the clustering task, we choose to use mixture model. 

\subsection{Representing Behaviours by Features}


\subsection{Customer Journeys and Markov Chains}

Schematic plot showing the relations between states and behaviors.

Schematic plot showing temporal transition of states.


\subsection{Clustering Using Mixture Model}

\paragraph{Generative process}

\begin{equation}
\mathbb{P} (\mathbf{y}, \mathbf{c}, \bm \theta) = \prod_{k=1}^K G_0 (\theta_k) \prod_{n=1}^N F(y_n | \theta_{c_n}) P(c_n)
\end{equation}

\begin{itemize}
\item $\mathbf{y} = \{y_1, y_2, \cdots, y_N \}$, observations
\item $\mathbf{c} = \{c_1, c_2, \cdots, c_N \}$, cluster assignments
\item $\bm \theta = \{\theta_1, \theta_2, \cdots, \theta_K \}$, cluster parameters
\item $G_0(\theta)$, a prior over the cluster parameters
\item $P(c)$, a prior over the mixing distribution
\item $F(y_n|\theta_{c_n})$, a hypothetical distribution over the observations
\item Assumptions: each observation is conditionally independent given its latent cluster assignments and the cluster parameters
\end{itemize}

\paragraph{Posterior probability of assignments}

\begin{equation}
\mathbb{P} (\mathbf{c} | \mathbf{y}) = \frac{\mathbb{P}(\mathbf{y} | \mathbf{c}) P(\mathbf{c})}{\sum_{\mathbf{c}} \mathbb{P}(\mathbf{y} | \mathbf{c}) P(\mathbf{c})},
\end{equation}
where
\begin{equation}
\mathbb{P}(\mathbf{y} | \mathbf{c}) = \int_\theta \left[ \prod_{n=1}^N F(y_n | \theta_{c_n}) \prod_{k=1}^K G_0 (\theta_k) \right] \text{d} \theta
\end{equation}


BNP clustering assume that there is an infinite number of latent clusters (namely $K \rightarrow +\infty$), but that a finite number of them is used to generate the observed data. There are an infinite number of clusters, though a finite data set only exhibits a finite number of active clusters.

\subsection{Modelling Pipeline}

Feature extraction

Features distributional modelling

Fitting mixture model

Analytic (churn rate calculation, clusters interpretation)